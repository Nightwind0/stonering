<!--DOCTYPE animations SYSTEM "Levels/level.dtd"-->
<animations>
    <animation name="move_to_attack" type="battle">
      <phase parallel="false" duration="300">
	<spriteAnimation name="move_to_attack">
	  <battleSprite who="caster" which="idle"/>
	  <spriteMovement initialFocus="locus" movementStyle="xonly" movementDirection="towards" distance="64"/>
	</spriteAnimation>
      </phase>
    </animation>
    <animation name="std_monster_attack" type="battle">
        <phase parallel="false" duration="200">
        </phase>
    </animation>
    <animation name="attack" type="battle">
	<phase parallel="true" duration="100">
	    <spriteAnimation name="attack">
		<battleSprite who="caster" which="attack"/>
	    </spriteAnimation>
	    <spriteAnimation name="attack_swing">
		<spriteStub who="caster" which="main"/>
		<!--spriteMovement initialFocus="locus" initalFocusX="left" initialFocusY="top" endFocus="locus" movementStyle="circle" circleStartAngle="290" rotation="45" circleDegrees="45" circleRadius="34" circleDirection="towards"-->
                <spriteMovement initialFocus="caster" endFocus="caster" initialFocusX="towards" initialFocusY="top" rotation="45" movementStyle="circle" circleStartAngle="225" circleDegrees="45" circleRadius="100" circleDirection="towards">
		</spriteMovement>
	    </spriteAnimation>
            <soundPlay sound="Sound/Swish"/>
	</phase>
        <phase parallel="true" duration="100">
            <spriteAnimation name="attack">
                <battleSprite who="caster" which="attack"/>
            </spriteAnimation>
            <spriteAnimation name="attack_swing">
                <spriteStub who="caster" which="main"/>
                <!--spriteMovement initialFocus="locus" initalFocusX="left" initialFocusY="top" endFocus="locus" movementStyle="circle" circleStartAngle="290" rotation="45" circleDegrees="45" circleRadius="34" circleDirection="towards"-->
                <spriteMovement initialFocus="caster" endFocus="caster" initialFocusX="towards" initialFocusY="top" rotation="45" movementStyle="circle" circleStartAngle="225" circleDegrees="45" circleRadius="100" circleDirection="towards">
                </spriteMovement>
            </spriteAnimation>
            <soundPlay sound="Sound/Swish"/>
        </phase>        
    </animation>
    <animation name="return_from_attack" type="battle">
	<phase parallel="false" duration="600">
	    <spriteAnimation name="return_from_attack">
		<battleSprite who="caster" which="idle"/>
		<spriteMovement initialFocus="caster" endFocus="locus"  movementStyle="xonly" movementCompletion="1.0"/>
	    </spriteAnimation>
	</phase>
    </animation>
    <animation name="recoil" type="battle">
	<phase parallel="false" duration="100">
            <soundPlay sound="Sound/FleshHit"/>
	    <spriteAnimation name="recoil">
		<battleSprite who="caster" which="recoil"/>
		<alterSprite who="caster" how="negative"/>
		<spriteMovement initialFocus="locus" endFocus="target"   rotation="-25" movementStyle="xonly" invert="true" movementCompletion="0.1"/>
	    </spriteAnimation>
	</phase>
	<phase parallel="false" duration="300">
	    <spriteAnimation name="recoil2">
		<battleSprite who="caster" which="idle"/>
                <alterSprite who="caster" how="reset"/>
		<spriteMovement initialFocus="caster" endFocus="locus"   movementStyle="xonly"  movementCompletion="1.0"/>
	    </spriteAnimation>
	</phase>
    </animation>
    <animation name="heal" type="battle">
	<phase parallel="true" duration="600">
	    <spriteAnimation name="heal">
		<spriteRef ref="Skills/Heal"/>
		<spriteMovement initialFocus="target" initialFocusY="top" initialFocusX="right" endFocusX="right" endFocusY="bottom" endFocus="target" movementStyle="straight"/>
	    </spriteAnimation>
	    <spriteAnimation name="heal2">
		<spriteRef ref="Skills/Heal"/>
		<spriteMovement initialFocus="target" initialFocusY="top" initialFocusX="left"  endFocusX="left" endFocusY="bottom" endFocus="target" movementStyle="straight"/>
	    </spriteAnimation>
	    <spriteAnimation name="heal3">
		<spriteRef ref="Skills/Heal"/>
		<spriteMovement initialFocus="target" initialFocusY="top" initialFocusX="center"  endFocusX="center" endFocusY="bottom" endFocus="target" movementStyle="straight"/>
	    </spriteAnimation>
	</phase>
    </animation>

    <animation name="hurl_balloon" type="battle">
	<phase parallel="false" duration="600">
	    <spriteAnimation name="throw">
		<spriteRef ref="Equipment/Ammo/Balloon_cyan"/>
		<spriteMovement initialFocus="caster" initialFocusY="top" endFocus="target" movementStyle="arc_over" amplitude="100" rotation="720"/>
	    </spriteAnimation>
	</phase>
	<phase parallel="false" duration="200">
	    <spriteAnimation name="pop">
		<spriteRef ref="Equipment/Ammo/Balloon_pop"/>
		<spriteMovement initialFocus="target" endFocus="target" movementStyle="straight"/>
	    </spriteAnimation>
	</phase>
    </animation>
    <animation name="wind_swept" type="battle">
	<phase parallel="true" duration="1000">
	    <spriteAnimation name="wind_sweep">
		<battleSprite who="target" which="recoil"/>
		<spriteMovement initialFocus="target" endFocus="target" movementStyle="straight">
		    	<spriteMovementScript  id="WindSweepPitch" type="spritePitch" >
		        <![CDATA[
			return math::sin($P*2);
			    ]]>
			</spriteMovementScript>
		    	<spriteMovementScript  id="WindSweepScale" type="spriteScale" >
		        <![CDATA[
			return math::sin($P*2);
			    ]]>
			</spriteMovementScript>
		</spriteMovement>
	    </spriteAnimation>
	</phase>
    </animation>
    <animation name="standard_monster_death" type="battle">
	<phase parallel="true" duration="700">
	    <spriteAnimation name="monster_death">
	    <battleSprite who="caster" which="recoil"/>

	    <spriteMovement initialFocus="caster" endFocus="caster" movementStyle="straight">
		<!--spriteMovementScript  id="StandardMonsterDeathAnimation_Alpha" type="spritePitch" >
		        <![CDATA[
			return $P * (3.1415926/2);
			    ]]>
		</spriteMovementScript-->
		<spriteMovementScript  id="StandardMonsterDeathAnimation_Alpha" type="alpha" >
		        <![CDATA[
			return 1.0 - $P;
			    ]]>
		</spriteMovementScript>
                <!--spriteMovementScript id="StandardMonsterDeathAnimation_Scale" type="spriteScale">
                    return 1.0 + $P*2.0;
                </spriteMovementScript-->
	    </spriteMovement>
	</spriteAnimation>
	<spriteAnimation name="red_for_death">
	    <battleSprite who="caster" which="recoil"/>
	    <alterSprite who="caster" how="redscale"/>
	</spriteAnimation>
	</phase>
    </animation>
    <animation name="fire_arrow" type="battle">
        <phase parallel="false" duration="200">
            <soundPlay sound="Sound/Arrow"/>
            <spriteAnimation name="pull">
                <spriteStub who="caster" which="main"/>
                <spriteMovement initialFocus="caster" initialFocusX="left" initialFocusY="center" endFocus="caster" endFocusX="towards" endFocusY="center" movementDierction="still">
                    <spriteMovementScript type="spriteRotation" id="fire_arrow_rotation">
                        return -45; // to compensate for the rotated icons
                    </spriteMovementScript>
                </spriteMovement>
            </spriteAnimation>
        </phase>
        <phase parallel="false" duration="200">
            <spriteAnimation name="arrow">
                <spriteRef ref="Equipment/Ammo/Arrow"/>
                <spriteMovement initialFocus="caster" initialFocusY="center" endFocus="target" movementStyle="straight" />
            </spriteAnimation>
        </phase>
    </animation>
    <animation name="stab" type="battle">
        <phase parallel="false" duration="100">
            <spriteAnimation name="stab1">
                <spriteStub who="caster" which="main"/>
                <spriteMovement initialFocus="caster" initialFocusY="center" initialFocusX="left" movementDirection="towards" movementStyle="straight" distance="30">
                    <spriteMovementScript type="spriteRotation" id="stab1_rotation">
                        return 45.0;
                    </spriteMovementScript>
                </spriteMovement>    
            </spriteAnimation>    
        </phase>
        <phase parallel="false" duration="100"/>
        <phase parallel="false" duration="100">
            <spriteAnimation name="stab2">
                <spriteStub who="caster" which="main"/>
                <spriteMovement initialFocus="caster" initialFocusY="center" initialFocusX="left" movementDirection="towards" movementStyle="straight" distance="30">
                    <spriteMovementScript type="spriteRotation" id="stab2_rotation">
                        return 45.0;
                    </spriteMovementScript>
                </spriteMovement>    
            </spriteAnimation>                
        </phase>        
    </animation>
</animations>
